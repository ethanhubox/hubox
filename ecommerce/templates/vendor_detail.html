{% extends 'base.html' %}

{% load static %}
{% load markdown_deux_tags %}

{% block meta_description %}{{ vendor.name }}{% endblock %}
{% block author %}{% endblock %}

{% block og_url %}{{ vendor.get_absolute_url }}{% endblock %}
{% block og_title %}{{ vendor.name }}{% endblock %}
{% block og_description %}{{ vendor.story|markdown|striptags }}{% endblock %}
{% block og_image %}{{ vendor.banner.url }}{% endblock %}

{% block title %}{{ vendor.name }}{% endblock %}

{% block css %}{% endblock %}

{% block cover_page %}


<!-- Cover-section starts here-->
  <section class="vendor-page-cover-section">
      <div class="vendor-page-cover-image-holder">
          <img src="{{ vendor.banner.url }}" />
      </div>
  </section>
<!-- Cover-section ends here-->

{% endblock %}

{% block content %}
  <section class="vendor-page-content-section">
    <div class="vendor-page-content-container">
      <div class="vendor-page-statistic-container-r">
          <div class="vendor-page-profile-row">
                  <div class="vendor-page-statistic-vendor-image">
                      <img src="{{ vendor.logo.url }}" />
                  </div>
              <div class="vendor-page-statistic-title-r">
                  <h1>{{ vendor.name }}</h1>
                  <p>{{ vendor.catagory }}</p>
                  <div class="vendor-page-social-icon-holder">
                      <a href="{{ vendor.facebook }}"><i class="fa fa-facebook-official" aria-hidden="true"></i></a>
                      <a href="{{ vendor.instagram }}"><i class="fa fa-instagram" aria-hidden="true"></i></a>
                      <a href="{{ vendor.youtube }}"><i class="fa fa-youtube" aria-hidden="true"></i></a>
                  </div>
              </div>
              <div class="vendor-page-follow-btn"><a href="#" type="button" class="btn btn-warning btn-lg subscribe-ajax">{% if subscribe %}已追蹤{% else %}加入追蹤{% endif %}</a></div>
          </div>
          <div class="vendor-page-statistic-pt-holder-r">
              <div class="vendor-page-statistic-course-r">
                  <div class="vendor-page-statistic-course-icon-r">
                      {{ vendor.course_set.all|length }}
                  </div>
                  <div class="vendor-page-statistic-course-label-r">
                      <span>學習體驗</span>
                  </div>
              </div>
              <div class="vendor-page-statistic-follow-r">
                  <div class="vendor-page-statistic-follow-icon-r">
                      {{ vendor.subscribe_number }}
                  </div>
                  <div class="vendor-page-statistic-follow-label-r">
                      <span>追蹤</span>
                  </div>
              </div>
              <div class="vendor-page-statistic-comment-r">
                  <div class="vendor-page-statistic-comment-icon-r">
                      4
                  </div>
                  <div class="vendor-page-statistic-comment-label-r">
                      <span>粉絲評鑑</span>
                  </div>
              </div>
          </div>
      </div>
      <div class="vendor-page-tab-container">
        <!-- Tab nav starts here-->
        <div class="vendor-page-tab-nav-container">
          <ul class="nav nav-tabs" id="myTabs" role="tablist">
              <li role="presentation" class="active">
                  <a href="#intro" aria-controls="intro" role="tab" data-toggle="tab">品牌故事</a>
              </li>
              <li role="presentation">
                  <a href="#image" aria-controls="image" role="tab" data-toggle="tab">品牌剪影</a>
              </li>
              <li role="presentation">
                  <a href="#others" aria-controls="others" role="tab" data-toggle="tab">所有學習</a>
              </li>
              <li role="presentation">
                  <a href="#comments" aria-controls="comments" role="tab" data-toggle="tab">粉絲評論</a>
              </li>
          </ul>
      </div>
      <!-- Tab nav ends here-->
      <!-- Tab panes starts here-->
      <div class="tab-content">
        <div role="tabpanel" class="tab-pane fade active in" id="intro">
            <div class="vendor-page-intro-container">
                <p>{{ vendor.story|markdown }}</p>
            </div>
        </div>
        <div role="tabpanel" class="tab-pane fade" id="image">
            <div class="vendor-page-image-container">
                <div data-type="youtube" data-video-id="{{ vendor.video }}"></div>
                {% for photo in vendor.vendormedia_set.all %}
                {% if photo.position == "剪影" %}
                <div class="vendor-page-image-holder"><img src="{{ photo.file.url }}" /></div>
                {% endif %}
                {% endfor %}
            </div>
        </div>
        <div role="tabpanel" class="tab-pane fade" id="others">
    <div class="vendor-page-course-tab-container-r">
        <!-- Vendor-page-r course-1 starts here-->
        {% for course in vendor.course_set.all %}
        <div class="allc-page-tab-row">
            <div class="allc-page-tab-image">
                <a href="{{ course.get_absolute_url }}"><img src="{{ course.coursemedia_set.all.0.file.url }}" /></a>
            </div>
            <div class="allc-page-tab-info">
                <a href="{{ course.get_absolute_url }}">
                    <div class="allc-page-tab-info-title">
                        {{ course.name }}
                    </div>
                </a>
                <div class="allc-page-tab-info-vendor">
                    <div class="allc-page-tab-info-vendor-logo">
                        <a href="{{ course.get_absolute_url }}">
                            <img src="{{ course.vendor.logo.url }}" />
                        </a>
                    </div>
                    <div class="allc-page-tab-info-vendor-name">
                        <a href="{{ course.get_absolute_url }}">
                            <h2>{{ course.vendor.name }}</h2>
                        </a>
                    </div>
                </div>
            </div>
            <div class="allc-page-tab-price">
                NTD {{ course.price }}
            </div>
        </div>
        {% endfor %}
        <!-- Vendor-page-r course-1 ends here-->

    </div>
</div>
<div role="tabpanel" class="tab-pane fade" id="comments">
    <div class="vendor-page-comment-tab-container">
        <div class="comment-row">
            <div class="comment-profile-image">
                <img src="{% static "img/icon1.jpg" %}" />
            </div>
            <div class="comment-bubble">
                <div class="comment-bubble-name-date">
                    <div class="comment-bubble-name">Simba</div>
                    <div class="comment-bubble-date"><span>Feb 8 2017</span><span>,3:40PM</span></div>
                </div>
                <div class="comment-bubble-content">課程很棒喔，加油！！希望能再多出一點種類的課程等等等等.... 課程很棒喔，加油！！希望能再多出一點種類的課程等等等等....課程很棒喔，加油！！希望能再多出一點種類的課程等等等等.... 課程很棒喔，加油！！希望能再多出一點種類的課程等等等等....課程很棒喔，加油！！希望能再多出一點種類的課程等等等等.... 課程很棒喔，加油！！
                </div>
                <div class="comment-stars">
                    <form action="">
                        <input class="comment-star comment-star-5" id="comment-star-5" type="radio" name="comment-star" />
                        <label class="comment-star comment-star-5" for="comment-star-5"></label>
                        <input class="comment-star comment-star-4" id="comment-star-4" type="radio" name="comment-star" />
                        <label class="comment-star comment-star-4" for="comment-star-4"></label>
                        <input class="comment-star comment-star-3" id="comment-star-3" type="radio" name="comment-star" />
                        <label class="comment-star comment-star-3" for="comment-star-3"></label>
                        <input class="comment-star comment-star-2" id="comment-star-2" type="radio" name="comment-star" />
                        <label class="comment-star comment-star-2" for="comment-star-2"></label>
                        <input class="comment-star comment-star-1" id="comment-star-1" type="radio" name="comment-star" />
                        <label class="comment-star comment-star-1" for="comment-star-1"></label>
                    </form>
                </div>
            </div>
        </div>
        <div class="comment-row">
            <div class="comment-profile-image">
                <img src="{% static "img/icon1.jpg" %}" />
            </div>
            <div class="comment-bubble">
                <div class="comment-bubble-name-date">
                    <div class="comment-bubble-name">Simba</div>
                    <div class="comment-bubble-date"><span>Feb 8 2017</span><span>,3:40PM</span></div>
                </div>
                <div class="comment-bubble-content">課程很棒喔，加油！！</div>
                <div class="comment-stars-1">
                    <form action="">
                        <input class="comment-star-1 comment-star-1-5" id="comment-star-1-5" type="radio" name="comment-star-1" />
                        <label class="comment-star-1 comment-star-1-5" for="comment-star-1-5"></label>
                        <input class="comment-star-1 comment-star-1-4" id="comment-star-1-4" type="radio" name="comment-star-1" />
                        <label class="comment-star-1 comment-star-1-4" for="comment-star-1-4"></label>
                        <input class="comment-star-1 comment-star-1-3" id="comment-star-1-3" type="radio" name="comment-star-1" />
                        <label class="comment-star-1 comment-star-1-3" for="comment-star-1-3"></label>
                        <input class="comment-star-1 comment-star-1-2" id="comment-star-1-2" type="radio" name="comment-star-1" />
                        <label class="comment-star-1 comment-star-1-2" for="comment-star-1-2"></label>
                        <input class="comment-star-1 comment-star-1-1" id="comment-star-1-1" type="radio" name="comment-star-1" />
                        <label class="comment-star-1 comment-star-1-1" for="comment-star-1-1"></label>
                    </form>
                </div>
            </div>
        </div>
        <div class="comment-row">
            <div class="comment-profile-image">
                <img src="{% static "img/icon1.jpg" %}" />
            </div>
            <div class="comment-bubble">
                <div class="comment-bubble-name-date">
                    <div class="comment-bubble-name">Simba</div>
                    <div class="comment-bubble-date"><span>Feb 8 2017</span><span>,3:40PM</span></div>
                </div>
                <div class="comment-bubble-content">課程很棒喔，加油！！</div>
                <div class="comment-stars-2">
                    <form action="">
                        <input class="comment-star-2 comment-star-2-5" id="comment-star-2-5" type="radio" name="comment-star-2" />
                        <label class="comment-star-2 comment-star-2-5" for="comment-star-2-5"></label>
                        <input class="comment-star-2 comment-star-2-4" id="comment-star-2-4" type="radio" name="comment-star-2" />
                        <label class="comment-star-2 comment-star-2-4" for="comment-star-2-4"></label>
                        <input class="comment-star-2 comment-star-2-3" id="comment-star-2-3" type="radio" name="comment-star-2" />
                        <label class="comment-star-2 comment-star-2-3" for="comment-star-2-3"></label>
                        <input class="comment-star-2 comment-star-2-2" id="comment-star-2-2" type="radio" name="comment-star-2" />
                        <label class="comment-star-2 comment-star-2-2" for="comment-star-2-2"></label>
                        <input class="comment-star-2 comment-star-2-1" id="comment-star-2-1" type="radio" name="comment-star-2" />
                        <label class="comment-star-2 comment-star-2-1" for="comment-star-2-1"></label>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>
      </div>
      </div>
    </div>
  </section>


{% endblock %}

{% block js %}
<!-- Footer-section ends here -->
</div>

<script src="{% static "js/plyr.js" %}"></script>
<script>
    plyr.setup();
</script>


<script>
function getCookie(name) {
    var cookieValue = null;
    if (document.cookie && document.cookie != '') {
        var cookies = document.cookie.split(';');
        for (var i = 0; i < cookies.length; i++) {
            var cookie = jQuery.trim(cookies[i]);
            // Does this cookie string begin with the name we want?
            if (cookie.substring(0, name.length + 1) == (name + '=')) {
                cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                break;
            }
        }
    }
    return cookieValue;
}

function csrfSafeMethod(method) {
    // these HTTP methods do not require CSRF protection
    return (/^(GET|HEAD|OPTIONS|TRACE)$/.test(method));
}
$.ajaxSetup({
    beforeSend: function(xhr, settings) {
    var csrftoken = getCookie('csrftoken');
    if (!csrfSafeMethod(settings.type) && !this.crossDomain) {
            xhr.setRequestHeader("X-CSRFToken", csrftoken);
        }
    }
});

$('.vendor-page-follow-btn').click(function (event) {
  event.preventDefault()
  $.ajax({
    type: "POST",
    url: "{% url "subscribe_ajax" %}",
    data: {"vendor": "{{ vendor.pk }}"},
    success: function(data) {
      console.log(data)
      $(".subscribe-ajax").text(data["subscribe"])

    },
    error: function(data) {
      console.log(data)
    }
  });
});

var description = $('.vendor-page-intro-container').text()
$("meta[property='og\\:description']").attr("content", description);


</script>

{% endblock %}
